<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Turtle Drawing â€” Mobile Friendly</title>
  <style>
    :root{
      --bg:#0b0b0b; --panel:rgba(0,0,0,0.55); --text:#fff; --muted:#ddd;
    }
    html,body{height:100%;margin:0;background:var(--bg);font-family:Inter, Arial, sans-serif; touch-action: manipulation;}
    .app{width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;}
    .canvas-wrap{position:relative;width:100vw;height:100vh;max-width:1360px;max-height:768px;}
    canvas{display:block;width:100%;height:100%;background:#000;}
    .top-instructions{position:absolute;top:12px;left:50%;transform:translateX(-50%);color:var(--text);background:var(--panel);padding:8px 12px;border-radius:8px;font-size:14px;font-weight:600;white-space: nowrap;}
    .status-panel{position:absolute;top:64px;left:16px;display:flex;flex-direction:column;gap:8px;background:var(--panel);padding:10px;border-radius:8px;color:var(--text);font-size:14px;min-width:160px;}
    .status-row{display:flex;justify-content:space-between;gap:8px;color:var(--muted);}
    .status-row span.value{font-weight:700;color:var(--text);}
    .text-overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);z-index:50;}
    .text-panel{background:#111;padding:18px;border-radius:10px;color:#fff;display:flex;gap:8px;align-items:center;flex-direction:column;}
    .text-panel input[type="text"]{padding:10px;background:#222;border:1px solid #333;color:#fff;border-radius:8px;min-width:200px;outline:none;width:80%;}
    .text-panel button{padding:10px 12px;border-radius:8px;border:none;background:#1976d2;color:#fff;cursor:pointer;font-weight:600;width:80%;margin-top:6px;}
    @media (max-width:720px){.status-panel{left:8px;top:8px;font-size:13px}.top-instructions{font-size:12px;padding:6px}}
  </style>
</head>
<body>
  <div class="app">
    <div class="canvas-wrap" id="canvasWrap">
      <div class="top-instructions" id="instructions">
        Controls: WASD = Move | Space = Pen | C = PenColor | B = BGColor | V = FillColor | F = Fill | Z = Undo | R = Reset | T = Text | K = Square | M = Speed | N = SnapLock
      </div>
      <div class="status-panel" id="statusPanel"></div>
      <canvas id="turtleCanvas" width="800" height="600"></canvas>

      <div id="textOverlay" class="text-overlay" style="display:none;">
        <div class="text-panel">
          <input id="textField" type="text" placeholder="Enter text to draw..." maxlength="80" />
          <button id="drawTextBtn">Draw</button>
          <button id="cancelTextBtn" style="background:#6b7280;">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <script>
  (function(){
    const canvas = document.getElementById('turtleCanvas');
    const ctx = canvas.getContext('2d');
    const CANVAS_W = 800, CANVAS_H = 600;

    function resizeCanvas(){
      const rect = canvas.getBoundingClientRect();
      canvas.width = CANVAS_W;
      canvas.height = CANVAS_H;
      canvas.style.width = rect.width + 'px';
      canvas.style.height = rect.height + 'px';
    }
    window.addEventListener('resize', resizeCanvas); 
    resizeCanvas();

    const $ = id => document.getElementById(id);

    const State = {
      x:CANVAS_W/2, y:CANVAS_H/2,
      heading:0, speed:5, is_pen_down:true,
      pen_color:'white', pen_size:4, paths:[],
      text_elements:[], bg_color:'black', fill_color:'white',
      is_filling:false, fill_points:[], snap_lock:false,
      COLOR_CYCLE:['white','red','blue','green','yellow','orange','purple','cyan','magenta','lime','pink','teal'],
      BG_COLOR_CYCLE:['black','darkslateblue','darkgreen','maroon','indigo','saddlebrown','#333333'],
      SPEED_CYCLE:[5,10,25,50,75,100]
    };
    let typingText=false;

    const textOverlay=$('textOverlay'), textField=$('textField'), drawTextBtn=$('drawTextBtn'), cancelTextBtn=$('cancelTextBtn');

    function updateStatus(){
      $('statusPanel').innerHTML = `
        <div class='status-row'>Pen: <span class='value'>${State.is_pen_down?'DOWN':'UP'}</span></div>
        <div class='status-row'>Pen Color: <span class='value'>${State.pen_color}</span></div>
        <div class='status-row'>Fill: <span class='value'>${State.is_filling?'ON':'OFF'}</span></div>
        <div class='status-row'>Fill Color: <span class='value'>${State.fill_color}</span></div>
        <div class='status-row'>Speed: <span class='value'>${State.speed}</span></div>
        <div class='status-row'>Snap Lock: <span class='value'>${State.snap_lock?'ON':'OFF'}</span></div>
      `;
    }

    function rad(deg){return deg*Math.PI/180;}
    function moveForward(){
      const r=rad(State.heading);
      const newX=State.x+State.speed*Math.cos(r);
      const newY=State.y-State.speed*Math.sin(r);
      if(State.is_pen_down) State.paths.push({start:{x:State.x,y:State.y},end:{x:newX,y:newY},color:State.pen_color,size:State.pen_size});
      if(State.is_filling) State.fill_points.push({x:State.x,y:State.y});
      State.x=newX; State.y=newY;
    }
    function moveBackward(){
      const r=rad(State.heading);
      const newX=State.x-State.speed*Math.cos(r);
      const newY=State.y+State.speed*Math.sin(r);
      if(State.is_pen_down) State.paths.push({start:{x:State.x,y:State.y},end:{x:newX,y:newY},color:State.pen_color,size:State.pen_size});
      if(State.is_filling) State.fill_points.push({x:State.x,y:State.y});
      State.x=newX; State.y=newY;
    }
    function turnLeft(){State.heading=(State.heading+(State.snap_lock?45:15))%360;}
    function turnRight(){State.heading=(State.heading-(State.snap_lock?45:15)+360)%360;}

    function showTextInput(){textOverlay.style.display='flex'; textField.value=''; textField.focus(); typingText=true;}
    function hideTextInput(){textOverlay.style.display='none'; typingText=false;}
    drawTextBtn.addEventListener('click',()=>{const txt=textField.value.trim(); if(txt.length>0) State.text_elements.push({content:txt,x:State.x,y:State.y,color:State.pen_color}); hideTextInput();});
    cancelTextBtn.addEventListener('click',hideTextInput);

    document.addEventListener('keydown', (e) => {
      if(typingText) return;
      const key = e.key.toLowerCase();
      if ([" ", "w", "a", "s", "d"].includes(key)) e.preventDefault();

      if (key === 'w') moveForward();
      else if (key === 's') moveBackward();
      else if (key === 'a') turnLeft();
      else if (key === 'd') turnRight();
      else if (key === ' ') State.is_pen_down = !State.is_pen_down;
      else if (key === 'c'){
        const idx = State.COLOR_CYCLE.indexOf(State.pen_color);
        State.pen_color = State.COLOR_CYCLE[(idx + 1) % State.COLOR_CYCLE.length];
      }
      else if (key === 'b'){
        const idx = State.BG_COLOR_CYCLE.indexOf(State.bg_color);
        State.bg_color = State.BG_COLOR_CYCLE[(idx + 1) % State.BG_COLOR_CYCLE.length];
      }
      else if (key === 'f') State.is_filling=!State.is_filling;
      else if (key === 'v'){
        const idx = State.COLOR_CYCLE.indexOf(State.fill_color);
        State.fill_color = State.COLOR_CYCLE[(idx+1)%State.COLOR_CYCLE.length];
      }
      else if (key === 'z' && State.paths.length>0) State.paths.pop();
      else if (key === 'r'){State.paths=[]; State.text_elements=[]; State.fill_points=[];}
      else if (key === 't') showTextInput();
      updateStatus();
    });

    function draw(){
      ctx.fillStyle = State.bg_color;
      ctx.fillRect(0,0,canvas.width,canvas.height);

      // draw paths
      State.paths.forEach(p=>{
        ctx.strokeStyle = p.color;
        ctx.lineWidth = p.size;
        ctx.beginPath();
        ctx.moveTo(p.start.x,p.start.y);
        ctx.lineTo(p.end.x,p.end.y);
        ctx.stroke();
      });

      // draw text
      State.text_elements.forEach(t=>{
        ctx.fillStyle = t.color;
        ctx.font = '16px Arial';
        ctx.fillText(t.content,t.x,t.y);
      });

      // draw turtle cursor
      ctx.save();
      ctx.translate(State.x,State.y);
      ctx.rotate(-rad(State.heading));
      ctx.fillStyle = 'lime';
      ctx.beginPath();
      ctx.moveTo(0,-10); 
      ctx.lineTo(5,5);
      ctx.lineTo(-5,5);
      ctx.closePath();
      ctx.fill();
      ctx.restore();

      requestAnimationFrame(draw);
    }

    updateStatus();
    draw();
  })();
  </script>
</body>
</html>


